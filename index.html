<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CoffeeMoll</title>

    <!-- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ Telegram -->
    <link rel="preload" href="https://telegram.org/js/telegram-web-app.js" as="script">
    
    <!-- –®—Ä–∏—Ñ—Ç—ã -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@500;700&family=Montserrat:wght@400;500;600;700&display=swap" as="style" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@500;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–∞—à–∏—Ö —Å—Ç–∏–ª–µ–π -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ WebApp -->
    <script>window.onerror = function(msg, url, line) { return false; };</script>
</head>
<body>

<!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
<div class="loading-overlay" id="loading-screen">
    <div class="spinner"></div>
    <div class="loading-title"><span class="logo-coffee">COFFEE</span><span class="logo-moll">MOLL</span></div>
    <div class="separator-line"></div>
    <div class="loading-motto">–ö–æ—Ñ–µ–π–Ω—è —Å –Ω–µ–ø—Ä–∏–ª–∏—á–Ω–æ –≤–∫—É—Å–Ω—ã–º –∫–æ—Ñ–µ</div>
</div>

<!-- –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô (TOAST) -->
<div id="toast-container"></div>

<!-- –≠–ö–†–ê–ù –û–®–ò–ë–ö–ò –°–í–Ø–ó–ò -->
<div class="loading-overlay" id="error-screen" style="display: none;">
    <div style="font-size: 50px; margin-bottom: 10px;">üì°</div>
    <div class="loading-title" style="font-size: 24px;">–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏</div>
    <div class="loading-motto">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.</div>
    <button class="error-btn" onclick="location.reload()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
</div>

<!-- –®–ê–ü–ö–ê (HEADER) -->
<div class="header-container">
    <header>
        <div class="header-left">
            <h1><span class="logo-coffee">COFFEE</span><span class="logo-moll">MOLL</span></h1>
            <div class="separator-line"></div>
            <div class="motto">–ö–æ—Ñ–µ–π–Ω—è —Å –Ω–µ–ø—Ä–∏–ª–∏—á–Ω–æ –≤–∫—É—Å–Ω—ã–º –∫–æ—Ñ–µ</div>
        </div>
        <div style="display:flex; align-items:center; gap:10px;">
            <div id="work-status" class="status-badge">Checking...</div>
        </div>
    </header>
    
    <!-- –ü–û–ò–°–ö -->
    <div class="search-wrapper">
        <input type="text" id="search-input" placeholder="üîç –ù–∞–π—Ç–∏..." oninput="filterMenu()">
    </div>
    
    <!-- –ö–ù–û–ü–ö–ê –ü–û–í–¢–û–†–ê –ó–ê–ö–ê–ó–ê (–°–ö–†–´–¢–ê –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
    <div id="repeat-order-container">
        <div class="repeat-card" onclick="loadLastOrder()">
            <div class="repeat-info">
                <div class="repeat-title">‚Üª –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ—à–ª—ã–π –∑–∞–∫–∞–∑</div>
                <div class="repeat-desc" id="repeat-desc">...</div>
                <div id="repeat-price" style="font-weight:bold; font-size:13px; color: var(--text-main);"></div>
            </div>
            <div class="repeat-icon">‚ûî</div>
        </div>
    </div>

    <!-- –ì–û–†–ò–ó–û–ù–¢–ê–õ–¨–ù–û–ï –ú–ï–ù–Æ (–ù–ê–í–ò–ì–ê–¶–ò–Ø) -->
    <div class="nav-scroller" id="nav-container"></div>
</div>

<!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† –ú–ï–ù–Æ -->
<div id="app"></div>

<!-- –ë–õ–û–ö "–ù–ò–ß–ï–ì–û –ù–ï –ù–ê–ô–î–ï–ù–û" -->
<div id="no-results">
    <span class="no-res-icon">üîç</span>
    <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å</p>
</div>

<!-- –ö–ù–û–ü–ö–ê –ù–ê–í–ï–†–• -->
<div class="scroll-top-btn" id="scroll-top" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</div>

<!-- –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ (–ü–õ–ê–í–ê–Æ–©–ê–Ø) -->
<div class="main-btn" id="cart-btn" onclick="openCheckout()">
    <span id="cart-text">–ö –∫–æ—Ä–∑–∏–Ω–µ</span>
    <div class="cart-counter" id="cart-count">0</div>
</div>

<!-- –ú–û–î–ê–õ–ö–ê –¢–û–í–ê–†–ê -->
<div class="modal-overlay" id="product-modal" onclick="closeProductModal(event)">
    <div class="modal-content" id="product-modal-content"></div>
</div>

<!-- –ú–û–î–ê–õ–ö–ê –û–§–û–†–ú–õ–ï–ù–ò–Ø –ó–ê–ö–ê–ó–ê -->
<div class="modal-overlay" id="checkout-modal"><div class="modal-content" id="checkout-content">
    <div class="modal-header">
        <div class="modal-title">–í–ê–® –ó–ê–ö–ê–ó</div>
        <div class="close-icon" onclick="closeCheckout()">‚úï</div>
    </div>
    
    <div id="closed-warning" class="warning-box">üåô <b>–ú—ã —Å–µ–π—á–∞—Å –∑–∞–∫—Ä—ã—Ç—ã.</b><br>–ü—Ä–∏–≥–æ—Ç–æ–≤–∏–º –≤–∞—à –∑–∞–∫–∞–∑ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (—Å 09:00).</div>
    <div id="pizza-warning" class="info-box">üçï <b>–ü–∏—Ü—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å 11:00.</b><br>–ù–∞—á–Ω–µ–º –≥–æ—Ç–æ–≤–∏—Ç—å –µ—ë –ø–æ—Å–ª–µ 11:00.</div>

    <div id="cart-list-container"></div>
    
    <!-- –ü–†–û–ú–û–ö–û–î -->
    <div class="promo-section" id="promo-container">
        <div style="display:flex; gap:5px; width:100%;">
             <input type="text" id="promo-code" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥" style="margin-bottom: 0; flex:1;">
             <button class="promo-btn" id="apply-promo-btn" onclick="applyPromo()">OK</button>
        </div>
    </div>

    <div class="checkout-total" id="checkout-total-sum">–ò—Ç–æ–≥–æ: 0 ‚Ç∏</div>
    <div style="margin-top: 20px; border-top: 5px solid #f3f4f6; margin-left: -20px; margin-right: -20px;"></div>
    <h3 style="margin: 15px 0 10px 0; font-size: 18px; font-family: var(--font-title); letter-spacing: 0.5px; font-weight: 700; color: var(--text-main);">–û–§–û–†–ú–õ–ï–ù–ò–ï</h3>
    
    <div class="option-group"><label class="option-label">–í–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</label>
        <input type="text" id="client-name" placeholder="–í–∞—à–µ –∏–º—è">
        <input type="tel" id="client-phone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+7...)">
    </div>
    
    <div class="option-group">
        <label class="option-label">–í—Ä–µ–º—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</label>
        <div class="checkout-radio-group">
            <input type="radio" name="orderTimeType" id="t-asap" value="asap" class="checkout-radio-input" checked onchange="toggleTimePicker()">
            <label for="t-asap" class="checkout-radio-label">‚ö° –ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ</label>

            <input type="radio" name="orderTimeType" id="t-time" value="time" class="checkout-radio-input" onchange="toggleTimePicker()">
            <label for="t-time" class="checkout-radio-label">‚è∞ –ö–æ –≤—Ä–µ–º–µ–Ω–∏</label>
        </div>
        <div id="time-picker-container" style="display: none; margin-top: 10px;">
            <input type="time" id="specific-time">
        </div>
    </div>

    <div class="option-group">
        <label class="option-label">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è</label>
        <div class="checkout-radio-group">
            <input type="radio" name="deliveryType" id="d-pickup" value="pickup" class="checkout-radio-input" checked onchange="toggleDelivery()">
            <label for="d-pickup" class="checkout-radio-label">üö∂ –°–∞–º–æ–≤—ã–≤–æ–∑</label>
            
            <input type="radio" name="deliveryType" id="d-dinein" value="dinein" class="checkout-radio-input" onchange="toggleDelivery()">
            <label for="d-dinein" class="checkout-radio-label">üçΩÔ∏è –í –∑–∞–ª–µ</label>
            
            <input type="radio" name="deliveryType" id="d-delivery" value="delivery" class="checkout-radio-input" onchange="toggleDelivery()">
            <label for="d-delivery" class="checkout-radio-label">üöó –î–æ—Å—Ç–∞–≤–∫–∞</label>
        </div>
        <div id="delivery-msg" class="delivery-warning">‚ö†Ô∏è –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ <b>–æ—Ç 600 ‚Ç∏ (–¥–æ –¥–≤–µ—Ä–∏ –æ—Ç 800 ‚Ç∏)</b> (–æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –∫—É—Ä—å–µ—Ä—É –æ—Ç–¥–µ–ª—å–Ω–æ).</div>
    </div>
    
    <div id="address-block" style="display: none;">
        <div class="option-group">
            <label class="option-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
            <textarea id="delivery-address" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞..."></textarea>
        </div>
    </div>
    
    <div class="option-group">
        <label class="option-label">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
        <div class="checkout-radio-group">
            <input type="radio" name="paymentType" id="p-cash" value="–ù–∞–ª–∏—á–Ω—ã–º–∏" class="checkout-radio-input" checked onchange="togglePayment()">
            <label for="p-cash" class="checkout-radio-label">üíµ –ù–∞–ª–∏—á–Ω—ã–µ</label>
            
            <input type="radio" name="paymentType" id="p-card" value="–ö–∞—Ä—Ç–æ–π" class="checkout-radio-input" onchange="togglePayment()">
            <label for="p-card" class="checkout-radio-label">üí≥ –ö–∞—Ä—Ç–æ–π</label>
            
            <input type="radio" name="paymentType" id="p-kaspi" value="Kaspi" class="checkout-radio-input" onchange="togglePayment()">
            <label for="p-kaspi" class="checkout-radio-label">üî¥ Kaspi</label>
            
            <input type="radio" name="paymentType" id="p-halyk" value="Halyk" class="checkout-radio-input" onchange="togglePayment()">
            <label for="p-halyk" class="checkout-radio-label">üü¢ Halyk</label>
        </div>
    </div>
    
    <div id="payment-phone-block" style="display: none;">
        <div class="option-group">
            <label class="option-label">–ù–æ–º–µ—Ä –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å—á–µ—Ç–∞</label>
            <input type="tel" id="payment-phone" placeholder="–ù–æ–º–µ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ –∫–∞—Ä—Ç–µ">
        </div>
    </div>
    
    <div class="option-group">
        <label class="option-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
        <textarea id="order-comment" placeholder="–ü–æ–∂–µ–ª–∞–Ω–∏—è..."></textarea>
    </div>
    
    <div class="contact-note">
        <input type="checkbox" checked disabled style="width: auto; margin: 0;">
        <span>–î–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–≤—è–∑—å –≤ —Å–ª—É—á–∞–µ –≤–æ–ø—Ä–æ—Å–æ–≤.</span>
    </div>
    
    <button class="modal-add-btn" id="submit-btn" onclick="submitOrder()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –ó–ê–ö–ê–ó</button>
</div></div>

<!-- –ú–û–î–ê–õ–ö–ê UPSELL (–î–û–ü–†–û–î–ê–ñ–ê) -->
<div class="upsell-overlay" id="upsell-modal"><div class="upsell-content">
    <h3 class="upsell-title">–ö –ö–û–§–ï –ò–î–ï–ê–õ–¨–ù–û –ü–û–î–û–ô–î–ï–¢!</h3>
    <img src="" alt="Upsell" class="upsell-img">
    <div class="upsell-product">–¢–û–í–ê–†</div>
    <div class="upsell-desc" id="upsell-price">0 ‚Ç∏</div>
    <div class="upsell-btn-row">
        <button class="upsell-no" onclick="closeUpsell()">–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ</button>
        <button class="upsell-yes" onclick="acceptUpsell()">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
</div></div>

<!-- –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –õ–û–ì–ò–ö–ò -->
<script src="script.js"></script>

</body>
</html>
